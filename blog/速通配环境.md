## 1、下载代理工具取代使用镜像源
>参考开源项目nelvko/clash-for-linux-install.
 
###  安装
在终端中执行以下命令，即可完成 Clash 的下载、安装与基础配置。
```shell
# 开启ebcloud的学术加速
source /public/bin/network_accelerate
# git仓库并cd进对应文件夹
git clone --branch master --depth 1 https://github.com/nelvko/clash-for-linux-install.git
cd clash-for-linux-install
# 由于开启了学术加速，不使用 gh-proxy.org ，直接连接 GitHub 官方服务器通常更稳定、更安全。
sed -i 's|https://gh-proxy.org||g' .env 2>/dev/null
sed -i 's|https://gh-proxy.org||g' install.sh
# 执行下载的sh文件，执行后需要准备机场url粘贴在终端
bash install.sh
# 关闭学术加速
source /public/bin/network_accelerate_stop
```

```我的机场
https://dash.knjc.cfd/api/v1/client/subscribe?token=a3bf795ae9fbca04056b2d4e74a38ac0
```


### 开启服务并验证
安装脚本执行完毕后，请按以下步骤开启服务并验证网络连通性（重启终端后）：
```bash
# 1. 开启代理服务 (启动 Clash 内核并设置系统代理)
clashon

# 2. 测试加速效果 (若返回 HTTP/2 200 或类似响应头，说明连接成功)
curl -I https://www.google.com

# 3. 关闭代理服务 (停止内核并清除系统代理)
clashoff
```


## 2、使用shell文件配置环境

>让ai根据文档写一个shell文件如setup.sh，在终端运行bash setup.sh即可

# setup.sh
```shell
#!/bin/bash
set -e # 遇到错误立即停止

# --- 定义颜色 ---
GREEN='\033[0;32m'
BLUE='\033[0;34m'
RED='\033[0;31m'
NC='\033[0m' # No Color

echo -e "${BLUE}=== LeHome Challenge 2026 一键安装脚本 (自动适配 root/sudo) ===${NC}"

# --- 0. 权限检测逻辑 ---
# 检测是否为 root 用户
if [ "$(id -u)" -eq 0 ]; then
    SUDO_CMD=""
    echo -e "${GREEN}>>> 检测到当前为 root 用户，将直接执行系统命令。${NC}"
else
    # 检测是否安装了 sudo
    if command -v sudo &> /dev/null; then
        SUDO_CMD="sudo"
        echo -e "${GREEN}>>> 检测到 sudo 工具，将使用 sudo 执行系统命令。${NC}"
    else
        echo -e "${RED}>>> 错误：当前不是 root 用户，且系统中未找到 'sudo' 命令。${NC}"
        echo "无法安装系统依赖。请切换到 root 用户或安装 sudo 后重试。"
        exit 1
    fi
fi

# --- 1. Git Clone 主仓库 ---
# 检查是否已经在 lehome-challenge 目录内
if [ -f "pyproject.toml" ] && [ -d "source/lehome" ]; then
    echo -e "${GREEN}>>> 检测到当前已在项目根目录下，跳过克隆。${NC}"
elif [ -d "lehome-challenge" ]; then
    echo -e "${GREEN}>>> 检测到 lehome-challenge 目录已存在，进入目录...${NC}"
    cd lehome-challenge
else
    echo -e "${GREEN}>>> [1/7] 克隆 lehome-challenge 仓库...${NC}"
    git clone https://github.com/lehome-official/lehome-challenge.git
    cd lehome-challenge
fi

# --- 2. 系统依赖 (可选) ---
echo -e "${BLUE}是否需要安装服务器系统依赖 (apt install)? (通常仅在裸机服务器/新容器需要)${NC}"
read -p "请输入 y 或 n: " INSTALL_SYS

if [[ "$INSTALL_SYS" == "y" ]]; then
    echo -e "${GREEN}>>> [2/7] 安装系统依赖...${NC}"
    
    # 使用之前定义的 SUDO_CMD 变量
    $SUDO_CMD apt update
    $SUDO_CMD apt install -y libglu1-mesa libgl1 libegl1 libxrandr2 libxinerama1 libxcursor1 libxi6 libxext6 libx11-6 git
    
    # 设置环境变量 (注意：export 只对当前 shell 有效，建议添加到 bashrc)
    export __GLX_VENDOR_LIBRARY_NAME=nvidia
    echo "环境变量 __GLX_VENDOR_LIBRARY_NAME 已设置为 nvidia"
else
    echo "跳过系统依赖安装。"
fi

# --- 3. UV 同步依赖 ---
echo -e "${GREEN}>>> [3/7] 使用 uv 同步 Python 依赖...${NC}"
# 检查 uv 是否存在
if ! command -v uv &> /dev/null; then
    echo -e "${RED}未找到 uv 命令。正在尝试安装 uv...${NC}"
    curl -LsSf https://astral.sh/uv/install.sh | sh
    source $HOME/.cargo/env || true
fi
uv sync

# --- 4. 配置 IsaacLab ---
echo -e "${GREEN}>>> [4/7] 克隆并配置 IsaacLab...${NC}"
mkdir -p third_party
if [ ! -d "third_party/IsaacLab" ]; then
    cd third_party
    git clone https://github.com/lehome-official/IsaacLab.git
    cd ..
else
    echo "IsaacLab 已存在，跳过克隆。"
fi

# --- 5. 安装 IsaacLab 和 LeHome ---
echo -e "${GREEN}>>> [5/7] 编译安装 IsaacLab 和 LeHome 包...${NC}"
# 在子shell中激活环境并执行安装
(
    source .venv/bin/activate
    
    # 安装 IsaacLab
    echo "正在运行 IsaacLab 安装脚本..."
    bash ./third_party/IsaacLab/isaaclab.sh -i none
    
    # 安装 LeHome
    echo "正在安装 LeHome..."
    uv pip install -e ./source/lehome
    
    # 确保 huggingface_hub[cli] 已安装 (防止 uv sync 没装上)
    uv pip install huggingface_hub[cli]
)

# --- 6. 下载仿真资产 (Assets) ---
echo -e "${GREEN}>>> [6/7] 从 HuggingFace 下载仿真资产 (Assets)...${NC}"
(
    source .venv/bin/activate
    mkdir -p Assets
    # 使用 hf 命令行工具下载
    huggingface-cli download lehome/asset_challenge --repo-type dataset --local-dir Assets
)

# --- 7. 下载示例数据集 (Datasets) ---
echo -e "${GREEN}>>> [7/7] 从 HuggingFace 下载示例数据集...${NC}"
(
    source .venv/bin/activate
    mkdir -p Datasets/example
    # 下载 Merged 版本
    huggingface-cli download lehome/dataset_challenge_merged --repo-type dataset --local-dir Datasets/example
)

echo -e "${BLUE}=== 安装全部完成！ ===${NC}"
echo -e "请运行以下命令开始使用："
echo -e "  cd lehome-challenge"   # 如果你是从外部运行的脚本
echo -e "  source .venv/bin/activate"
echo -e "  export __GLX_VENDOR_LIBRARY_NAME=nvidia"
```


## 3、软链接解决系统盘内存不足问题

#### 1. 移动现有文件夹
假设你不想删除旧缓存，而是想把它们搬过去：

```bash
# 1. 确保 uv 没有在运行
# 2. 创建目标父目录
mkdir -p /data/local_uv

# 3. 移动现有的 uv 缓存目录到 data 盘
# 注意：如果目录不存在（比如你刚装好），可以跳过 mv，直接 mkdir
mv ~/.cache/uv /data/local_uv/cache_uv
```

#### 2. 创建软链接
现在系统盘的 `~/.cache/uv` 没了，我们创建一个指向 `/data` 的链接：

```bash
# 创建软链接： 让 ~/.cache/uv 指向 /data/local_uv/cache_uv
ln -s /data/local_uv/cache_uv ~/.cache/uv
```

#### 3. 验证
查看链接是否建立成功：
```bash
ls -l ~/.cache/uv
```
如果显示类似 `~/.cache/uv -> /data/local_uv/cache_uv`，说明成功了。以后所有写入 `~/.cache/uv` 的数据，实际上都存到了 `/data` 盘。

